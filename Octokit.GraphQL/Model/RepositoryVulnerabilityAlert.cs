namespace Octokit.GraphQL.Model
{
    using System;
    using System.Collections.Generic;
    using System.Linq.Expressions;
    using Octokit.GraphQL.Core;
    using Octokit.GraphQL.Core.Builders;

    /// <summary>
    /// A Dependabot alert for a repository with a dependency affected by a security vulnerability.
    /// </summary>
    public class RepositoryVulnerabilityAlert : QueryableValue<RepositoryVulnerabilityAlert>
    {
        internal RepositoryVulnerabilityAlert(Expression expression) : base(expression)
        {
        }

        /// <summary>
        /// When was the alert auto-dismissed?
        /// </summary>
        public DateTimeOffset? AutoDismissedAt { get; }

        /// <summary>
        /// When was the alert created?
        /// </summary>
        public DateTimeOffset CreatedAt { get; }

        /// <summary>
        /// The associated Dependabot update
        /// </summary>
        public DependabotUpdate DependabotUpdate => this.CreateProperty(x => x.DependabotUpdate, Octokit.GraphQL.Model.DependabotUpdate.Create);

        /// <summary>
        /// The scope of an alert's dependency
        /// </summary>
        public RepositoryVulnerabilityAlertDependencyScope? DependencyScope { get; }

        /// <summary>
        /// Comment explaining the reason the alert was dismissed
        /// </summary>
        public string DismissComment { get; }

        /// <summary>
        /// The reason the alert was dismissed
        /// </summary>
        public string DismissReason { get; }

        /// <summary>
        /// When was the alert dismissed?
        /// </summary>
        public DateTimeOffset? DismissedAt { get; }

        /// <summary>
        /// The user who dismissed the alert
        /// </summary>
        public User Dismisser => this.CreateProperty(x => x.Dismisser, Octokit.GraphQL.Model.User.Create);

        /// <summary>
        /// When was the alert fixed?
        /// </summary>
        public DateTimeOffset? FixedAt { get; }

        /// <summary>
        /// The Node ID of the RepositoryVulnerabilityAlert object
        /// </summary>
        public ID Id { get; }

        /// <summary>
        /// Identifies the alert number.
        /// </summary>
        public int Number { get; }

        /// <summary>
        /// The associated repository
        /// </summary>
        public Repository Repository => this.CreateProperty(x => x.Repository, Octokit.GraphQL.Model.Repository.Create);

        /// <summary>
        /// The associated security advisory
        /// </summary>
        public SecurityAdvisory SecurityAdvisory => this.CreateProperty(x => x.SecurityAdvisory, Octokit.GraphQL.Model.SecurityAdvisory.Create);

        /// <summary>
        /// The associated security vulnerability
        /// </summary>
        public SecurityVulnerability SecurityVulnerability => this.CreateProperty(x => x.SecurityVulnerability, Octokit.GraphQL.Model.SecurityVulnerability.Create);

        /// <summary>
        /// Identifies the state of the alert.
        /// </summary>
        public RepositoryVulnerabilityAlertState State { get; }

        /// <summary>
        /// The vulnerable manifest filename
        /// </summary>
        public string VulnerableManifestFilename { get; }

        /// <summary>
        /// The vulnerable manifest path
        /// </summary>
        public string VulnerableManifestPath { get; }

        /// <summary>
        /// The vulnerable requirements
        /// </summary>
        public string VulnerableRequirements { get; }

        internal static RepositoryVulnerabilityAlert Create(Expression expression)
        {
            return new RepositoryVulnerabilityAlert(expression);
        }
    }
}